<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRO-SCOUT V12 | Kesintisiz Taktik Board</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --neon: #00ff88; --bg: #030508; }
        body { background: var(--bg); color: #e2e8f0; font-family: 'Inter', sans-serif; overflow: hidden; }
        
        /* SAHA TASARIMI */
        .pitch { 
            background: #080a0f; border: 2px solid #1f2937; position: relative; height: 680px; width: 100%; border-radius: 20px;
            background-image: radial-gradient(circle, #1a1d23 1.5px, transparent 1.5px); background-size: 40px 40px;
        }

        /* MEVKİ SLOTLARI */
        .pos-slot {
            position: absolute; width: 68px; height: 68px; border: 1px solid #1f2937; border-radius: 50%;
            transform: translate(-50%, -50%); display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.85); cursor: pointer; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 10;
        }
        .pos-slot:hover { border-color: var(--neon); transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 15px rgba(0,255,136,0.1); }
        .slot-active { border-color: var(--neon); background: rgba(0, 255, 136, 0.05); }

        /* OYUNCU KARTLARI */
        .scout-card {
            background: #0d1117; border: 1px solid #1f2937; padding: 12px; border-radius: 10px; margin-bottom: 8px;
            cursor: pointer; border-left: 4px solid transparent; transition: 0.2s;
        }
        .scout-card:hover { background: #161b22; }
        .selected-player { border-left-color: var(--neon) !important; background: #1a2333 !important; }

        /* DURUM İKONLARI */
        .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
        .status-fit { background: #00ff88; box-shadow: 0 0 8px #00ff88; }
        .status-tired { background: #ffcc00; box-shadow: 0 0 8px #ffcc00; }
        .status-injured { background: #ff4444; box-shadow: 0 0 8px #ff4444; }

        .btn-active { background: var(--neon) !important; color: #000 !important; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body class="p-6">

    <div class="max-w-[1600px] mx-auto">
        <header class="flex justify-between items-center mb-6 bg-[#0d1117] p-6 rounded-xl border border-gray-800 shadow-2xl">
            <div class="flex items-center gap-8">
                <h1 class="text-2xl font-black italic text-white tracking-tighter uppercase">SCOUT <span class="text-[var(--neon)]">V12</span></h1>
                <div class="flex gap-2 p-1 bg-black rounded-lg">
                    <button onclick="setPhase('toplu')" id="btn-toplu" class="btn-active text-[10px] font-black px-6 py-2 rounded uppercase transition-all">Toplu Alan</button>
                    <button onclick="setPhase('topsuz')" id="btn-topsuz" class="text-[10px] font-black px-6 py-2 rounded uppercase text-gray-500 transition-all">Topsuz Alan</button>
                </div>
            </div>
            
            <div class="flex gap-3">
                <input id="manName" type="text" placeholder="Manuel Oyuncu Ekle..." class="bg-gray-900 border border-gray-700 text-xs p-3 rounded w-56 text-white outline-none focus:border-green-500">
                <button onclick="addManual()" class="bg-white text-black font-black px-6 rounded text-xs uppercase hover:bg-gray-200">Ekle</button>
                <button onclick="fetchData()" id="fetchBtn" class="bg-[var(--neon)] text-black font-black px-6 rounded text-xs uppercase hover:opacity-80">Oyuncu Öner</button>
            </div>
        </header>

        <div class="grid grid-cols-12 gap-8">
            <div class="col-span-3">
                <h3 class="text-[10px] font-bold text-gray-500 mb-4 uppercase tracking-[0.2em]">Filtrelenmiş Veri Akışı</h3>
                <div id="results" class="max-h-[680px] overflow-y-auto pr-2 space-y-3">
                    <div class="text-center py-20 opacity-30 text-xs italic italic">Sistem hazır. Veri çekmek için butona basın.</div>
                </div>
            </div>

            <div class="col-span-9">
                <div class="pitch" id="pitch"></div>
                <div id="hint" class="invisible mt-4 text-center bg-green-500/10 border border-green-500/20 py-2 rounded-lg">
                    <span class="text-[11px] text-green-500 font-black animate-pulse uppercase tracking-widest">
                        Oyuncu Seçildi! Yerleştirmek için sahadaki bir yuvaya tıklayın.
                    </span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const phases = {
            toplu: [ 
                {pos: "KL", t: 90, l: 50}, {pos: "STP", t: 78, l: 38}, {pos: "STP", t: 78, l: 62},
                {pos: "SLB", t: 55, l: 10}, {pos: "SĞB", t: 55, l: 90}, {pos: "MO", t: 62, l: 50},
                {pos: "MO", t: 45, l: 30}, {pos: "MO", t: 45, l: 70}, {pos: "SLK", t: 20, l: 15},
                {pos: "SĞK", t: 20, l: 85}, {pos: "SNT", t: 10, l: 50}
            ],
            topsuz: [
                {pos: "KL", t: 92, l: 50}, {pos: "STP", t: 82, l: 44}, {pos: "STP", t: 82, l: 56},
                {pos: "SLB", t: 80, l: 25}, {pos: "SĞB", t: 80, l: 75}, {pos: "MO", t: 72, l: 50},
                {pos: "MO", t: 68, l: 38}, {pos: "MO", t: 68, l: 62}, {pos: "SLK", t: 58, l: 30},
                {pos: "SĞK", t: 58, l: 70}, {pos: "SNT", t: 48, l: 50}
            ]
        };

        let squad = Array(11).fill(null);
        let currentPhase = 'toplu';
        let selectedPlayer = null;
        let seenNames = new Set(); // Mükerrer oyuncu kontrolü

        async function fetchData() {
            const resDiv = document.getElementById('results');
            resDiv.innerHTML = '<p class="text-[10px] text-center py-10 animate-pulse text-green-500">Wikipedia Taranıyor...</p>';
            seenNames.clear();

            const sparql = `
                SELECT DISTINCT ?name ?teamName ?desc WHERE {
                    ?player a <http://dbpedia.org/ontology/SoccerPlayer> ;
                            <http://xmlns.com/foaf/0.1/name> ?name ;
                            <http://dbpedia.org/ontology/team> ?team ;
                            <http://dbpedia.org/ontology/abstract> ?desc .
                    ?team <http://xmlns.com/foaf/0.1/name> ?teamName .
                    FILTER (LANG(?desc) = "en")
                } LIMIT 100`;

            try {
                const response = await fetch("https://dbpedia.org/sparql?query=" + encodeURIComponent(sparql) + "&format=json");
                const data = await response.json();
                renderResults(data.results.bindings);
            } catch (e) {
                renderResults(null); 
            }
        }

        function renderResults(apiData) {
            const resDiv = document.getElementById('results');
            resDiv.innerHTML = "";
            
            const backup = [
                {name: {value: "Viktor Gyökeres"}, teamName: {value: "Sporting CP"}, desc: {value: "striker forward"}},
                {name: {value: "Lamine Yamal"}, teamName: {value: "Barcelona"}, desc: {value: "winger"}},
                {name: {value: "Kenan Yıldız"}, teamName: {value: "Juventus"}, desc: {value: "forward"}},
                {name: {value: "Rodri"}, teamName: {value: "Man City"}, desc: {value: "midfielder"}}
            ];

            const players = apiData && apiData.length > 0 ? apiData : backup;

            players.forEach(p => {
                const name = p.name.value;
                const team = p.teamName.value;
                const desc = p.desc.value.toLowerCase();

                // AYNI OYUNCUYU ENGELLE
                if(seenNames.has(name) || name.length < 3 || name.includes("http")) return;
                seenNames.add(name);

                // MEVKİ TESPİTİ
                let detectedPos = "MO";
                if(desc.includes("goalkeeper")) detectedPos = "KL";
                else if(desc.includes("defender") || desc.includes("centre-back")) detectedPos = "STP";
                else if(desc.includes("forward") || desc.includes("striker")) detectedPos = "SNT";
                else if(desc.includes("winger") || desc.includes("winger")) detectedPos = "KANAT";

                const rand = Math.random();
                const statusClass = rand > 0.8 ? 'status-tired' : (rand < 0.1 ? 'status-injured' : 'status-fit');

                const card = document.createElement('div');
                card.className = 'scout-card';
                card.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-[11px] font-black text-white uppercase">${name}</span>
                        <span class="status-dot ${statusClass}"></span>
                    </div>
                    <div class="flex justify-between items-center text-[9px] font-bold">
                        <span class="text-gray-500 uppercase">${team}</span>
                        <span class="text-[var(--neon)]">${detectedPos}</span>
                    </div>
                `;
                card.onclick = () => {
                    document.querySelectorAll('.scout-card').forEach(c => c.classList.remove('selected-player'));
                    card.classList.add('selected-player');
                    selectedPlayer = { name, detectedPos, statusClass };
                    document.getElementById('hint').classList.remove('invisible');
                };
                resDiv.appendChild(card);
            });
        }

        function renderPitch() {
            const pitch = document.getElementById('pitch');
            pitch.innerHTML = "";
            phases[currentPhase].forEach((slot, i) => {
                const p = squad[i];
                const div = document.createElement('div');
                div.className = `pos-slot ${p ? 'slot-active' : ''}`;
                div.style.top = slot.t + "%"; div.style.left = slot.l + "%";
                div.innerHTML = `
                    <span class="text-[8px] text-gray-600 font-black mb-1">${slot.pos}</span>
                    <span class="text-[9px] font-black text-white text-center leading-tight uppercase px-1">${p ? p.name.split(' ')[0] : ''}</span>
                    ${p ? `<div class="status-dot ${p.statusClass} mt-1" style="width:5px; height:5px;"></div>` : ''}
                `;
                div.onclick = () => {
                    if (selectedPlayer) {
                        squad[i] = selectedPlayer;
                        selectedPlayer = null;
                        document.getElementById('hint').classList.add('invisible');
                        document.querySelectorAll('.scout-card').forEach(c => c.classList.remove('selected-player'));
                        renderPitch();
                    } else if (squad[i]) { 
                        squad[i] = null; 
                        renderPitch(); 
                    }
                };
                pitch.appendChild(div);
            });
        }

        function setPhase(p) {
            currentPhase = p;
            document.getElementById('btn-toplu').className = p === 'toplu' ? 'btn-active text-[10px] font-black px-6 py-2 rounded uppercase' : 'text-[10px] font-black px-6 py-2 rounded uppercase text-gray-500';
            document.getElementById('btn-topsuz').className = p === 'topsuz' ? 'btn-active text-[10px] font-black px-6 py-2 rounded uppercase' : 'text-[10px] font-black px-6 py-2 rounded uppercase text-gray-500';
            renderPitch();
        }

        function addManual() {
            const name = document.getElementById('manName').value;
            if(name) {
                selectedPlayer = { name, detectedPos: "MANUEL", statusClass: 'status-fit' };
                document.getElementById('hint').classList.remove('invisible');
                document.getElementById('manName').value = "";
            }
        }

        renderPitch();
    </script>
</body>
</html>
