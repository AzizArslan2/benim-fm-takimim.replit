<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>PRO-SCOUT V13 | Kararlı Sistem</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --neon: #00ff88; --bg: #030508; }
        body { background: var(--bg); color: #e2e8f0; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; }
        
        /* Sabit Layout */
        .app-container { display: grid; grid-template-columns: 350px 1fr; gap: 20px; height: calc(100vh - 120px); padding: 0 20px; }
        
        /* Saha */
        .pitch { 
            background: #080a0f; border: 2px solid #1f2937; position: relative; height: 100%; border-radius: 20px;
            background-image: radial-gradient(circle, #1a1d23 1.5px, transparent 1.5px); background-size: 40px 40px;
        }

        .pos-slot {
            position: absolute; width: 65px; height: 65px; border: 1px solid #1f2937; border-radius: 50%;
            transform: translate(-50%, -50%); display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.9); cursor: pointer; transition: 0.2s; z-index: 10;
        }
        .pos-slot:hover { border-color: var(--neon); transform: translate(-50%, -50%) scale(1.1); }
        .slot-active { border-color: var(--neon); background: rgba(0, 255, 136, 0.1); }

        /* Kartlar */
        .scout-card {
            background: #0d1117; border: 1px solid #1f2937; padding: 12px; border-radius: 10px; margin-bottom: 10px;
            cursor: pointer; border-left: 4px solid transparent; transition: 0.2s;
        }
        .scout-card:hover { background: #161b22; }
        .selected { border-left-color: var(--neon) !important; background: #1a2333 !important; }

        .status-fit { color: #00ff88; font-size: 10px; }
        .status-tired { color: #ffcc00; font-size: 10px; }
        
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body class="p-4">

    <header class="flex justify-between items-center mb-6 bg-[#0d1117] p-5 rounded-xl border border-gray-800 mx-4">
        <h1 class="text-xl font-black italic text-white">PRO-SCOUT <span class="text-[var(--neon)]">V13</span></h1>
        <div class="flex gap-2">
            <button onclick="setPhase('toplu')" id="btn-toplu" class="bg-[var(--neon)] text-black font-bold px-4 py-2 rounded text-[10px] uppercase">Toplu Alan</button>
            <button onclick="setPhase('topsuz')" id="btn-topsuz" class="bg-gray-800 text-white font-bold px-4 py-2 rounded text-[10px] uppercase">Topsuz Alan</button>
        </div>
        <div class="flex gap-2">
            <input id="manName" type="text" placeholder="Manuel Oyuncu..." class="bg-gray-900 border border-gray-700 text-xs p-2 rounded w-40 text-white outline-none">
            <button onclick="addManual()" class="bg-white text-black font-bold px-4 rounded text-xs uppercase">Ekle</button>
            <button onclick="fetchData()" id="fetchBtn" class="bg-blue-600 text-white font-bold px-4 rounded text-xs uppercase">Oyuncu Öner</button>
        </div>
    </header>

    <div class="app-container">
        <div class="flex flex-col h-full overflow-hidden">
            <h3 class="text-[10px] font-bold text-gray-500 mb-3 uppercase tracking-widest">Önerilen Oyuncular</h3>
            <div id="results" class="flex-1 overflow-y-auto pr-2">
                <p class="text-xs text-gray-600 italic text-center mt-10">Bağlantı bekleniyor...</p>
            </div>
        </div>

        <div class="flex flex-col h-full">
            <div class="pitch" id="pitch"></div>
            <p id="hint" class="text-center text-[11px] text-green-500 mt-2 font-bold opacity-0">OYUNCU SEÇİLDİ: SAHADAKİ MEVKİYE TIKLA</p>
        </div>
    </div>

    <script>
        const positions = {
            toplu: [ 
                {pos: "KL", t: 90, l: 50}, {pos: "STP", t: 78, l: 40}, {pos: "STP", t: 78, l: 60},
                {pos: "SLB", t: 60, l: 12}, {pos: "SĞB", t: 60, l: 88}, {pos: "MO", t: 65, l: 50},
                {pos: "MO", t: 45, l: 30}, {pos: "MO", t: 45, l: 70}, {pos: "SLK", t: 25, l: 15},
                {pos: "SĞK", t: 25, l: 85}, {pos: "SNT", t: 15, l: 50}
            ],
            topsuz: [
                {pos: "KL", t: 92, l: 50}, {pos: "STP", t: 82, l: 45}, {pos: "STP", t: 82, l: 55},
                {pos: "SLB", t: 80, l: 25}, {pos: "SĞB", t: 80, l: 75}, {pos: "MO", t: 72, l: 50},
                {pos: "MO", t: 68, l: 38}, {pos: "MO", t: 68, l: 62}, {pos: "SLK", t: 55, l: 30},
                {pos: "SĞK", t: 55, l: 70}, {pos: "SNT", t: 45, l: 50}
            ]
        };

        let squad = Array(11).fill(null);
        let currentPhase = 'toplu';
        let selectedPlayer = null;

        async function fetchData() {
            const resDiv = document.getElementById('results');
            resDiv.innerHTML = '<p class="text-xs text-center animate-pulse text-blue-500">Veri aranıyor...</p>';
            
            try {
                const sparql = `SELECT DISTINCT ?name ?team ?desc WHERE { ?player a <http://dbpedia.org/ontology/SoccerPlayer> ; <http://xmlns.com/foaf/0.1/name> ?name ; <http://dbpedia.org/ontology/team> ?t ; <http://dbpedia.org/ontology/abstract> ?desc . ?t <http://xmlns.com/foaf/0.1/name> ?team . FILTER (LANG(?desc) = "en") } LIMIT 50`;
                const response = await fetch("https://dbpedia.org/sparql?query=" + encodeURIComponent(sparql) + "&format=json");
                const data = await response.json();
                renderCards(data.results.bindings);
            } catch (e) {
                // Yedek Veri (API çökerse burası çalışır)
                const backup = [
                    {name:{value:"Viktor Gyökeres"}, team:{value:"Sporting CP"}, desc:{value:"striker"}},
                    {name:{value:"Lamine Yamal"}, team:{value:"FC Barcelona"}, desc:{value:"winger"}},
                    {name:{value:"Kenan Yıldız"}, team:{value:"Juventus"}, desc:{value:"forward"}},
                    {name:{value:"Arda Güler"}, team:{value:"Real Madrid"}, desc:{value:"midfielder"}}
                ];
                renderCards(backup);
            }
        }

        function renderCards(players) {
            const resDiv = document.getElementById('results');
            resDiv.innerHTML = "";
            let seen = new Set();

            players.forEach(p => {
                const name = p.name.value;
                const team = p.team.value;
                const desc = p.desc.value.toLowerCase();
                
                if(seen.has(name) || name.length < 3) return;
                seen.add(name);

                let mevki = "MO";
                if(desc.includes("goalkeeper")) mevki = "KL";
                else if(desc.includes("defender")) mevki = "STP";
                else if(desc.includes("striker") || desc.includes("forward")) mevki = "SNT";
                else if(desc.includes("winger")) mevki = "KANAT";

                const card = document.createElement('div');
                card.className = "scout-card";
                card.innerHTML = `
                    <div class="flex justify-between font-bold text-xs"><span>${name}</span><span class="text-blue-400">${mevki}</span></div>
                    <div class="text-[9px] text-gray-500 mt-1 uppercase">${team}</div>
                `;
                card.onclick = () => {
                    document.querySelectorAll('.scout-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    selectedPlayer = { name, mevki };
                    document.getElementById('hint').style.opacity = "1";
                };
                resDiv.appendChild(card);
            });
        }

        function renderPitch() {
            const pitch = document.getElementById('pitch');
            pitch.innerHTML = "";
            positions[currentPhase].forEach((slot, i) => {
                const p = squad[i];
                const div = document.createElement('div');
                div.className = `pos-slot ${p ? 'slot-active' : ''}`;
                div.style.top = slot.t + "%"; div.style.left = slot.l + "%";
                div.innerHTML = `<span class="text-[8px] text-gray-500 font-bold">${slot.pos}</span>
                                 <span class="text-[9px] font-bold text-white uppercase">${p ? p.name.split(' ')[0] : ''}</span>`;
                div.onclick = () => {
                    if(selectedPlayer) {
                        squad[i] = selectedPlayer;
                        selectedPlayer = null;
                        document.getElementById('hint').style.opacity = "0";
                        renderPitch();
                    } else if(squad[i]) {
                        squad[i] = null;
                        renderPitch();
                    }
                };
                pitch.appendChild(div);
            });
        }

        function setPhase(p) {
            currentPhase = p;
            document.getElementById('btn-toplu').className = p === 'toplu' ? 'bg-[var(--neon)] text-black font-bold px-4 py-2 rounded text-[10px]' : 'bg-gray-800 text-white font-bold px-4 py-2 rounded text-[10px]';
            document.getElementById('btn-topsuz').className = p === 'topsuz' ? 'bg-[var(--neon)] text-black font-bold px-4 py-2 rounded text-[10px]' : 'bg-gray-800 text-white font-bold px-4 py-2 rounded text-[10px]';
            renderPitch();
        }

        function addManual() {
            const name = document.getElementById('manName').value;
            if(name) {
                selectedPlayer = { name, mevki: "MAN" };
                document.getElementById('hint').style.opacity = "1";
                document.getElementById('manName').value = "";
            }
        }

        renderPitch();
    </script>
</body>
</html>
