<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FM26 Taktik TahtasÄ± - Pro Versiyon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --team-color: #1a7a3a; }
        body { background-color: #0d1117; color: #e6edf3; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        
        /* SAHA TASARIMI */
        .pitch { 
            background: #1e3d24; border: 4px solid #ffffff33; position: relative; height: 750px; width: 100%; border-radius: 20px;
            background-image: repeating-linear-gradient(#244a2b 0, #244a2b 50px, #1e3d24 50px, #1e3d24 100px);
            box-shadow: inset 0 0 100px rgba(0,0,0,0.8); transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .pitch.defensive { background-color: #2b1a1a; background-image: repeating-linear-gradient(#3d1e1e 0, #3d1e1e 50px, #2b1a1a 50px, #2b1a1a 100px); }

        /* OYUNCU Ä°KONLARI */
        .player-slot { 
            position: absolute; width: 100px; text-align: center; z-index: 20; 
            transition: all 0.7s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
        }
        .kit-icon { 
            width: 52px; height: 52px; margin: 0 auto; background-color: var(--team-color); 
            border: 2px solid white; border-radius: 10px; cursor: grab;
            display: flex; align-items: center; justify-content: center; font-weight: bold;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        .player-name-label { 
            font-size: 10px; font-weight: bold; background: rgba(0,0,0,0.85); padding: 3px; 
            border-radius: 5px; margin-top: 6px; min-height: 22px; border: 1px solid #444; color: white;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        
        /* YEDEK KULÃœBESÄ° */
        .bench-item { 
            cursor: grab; background: #161b22; border: 1px solid #30363d; padding: 12px; 
            border-radius: 12px; font-size: 12px; font-weight: 700; transition: 0.2s;
        }
        .bench-item:hover { border-color: var(--team-color); transform: translateX(8px); background: #1c2128; }
        .pos-badge { font-size: 9px; font-weight: 900; color: #ffffffaa; text-transform: uppercase; margin-bottom: 2px; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 10px; }
    </style>
</head>
<body class="p-4 lg:p-6">
    <div class="max-w-[1600px] mx-auto">
        
        <header class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8 bg-gray-900 p-6 rounded-3xl border border-gray-800 shadow-2xl">
            <div class="space-y-4">
                <div class="flex items-center gap-4">
                    <div id="teamLogo" class="w-14 h-14 bg-white rounded-xl flex items-center justify-center font-black text-black text-2xl border-4 border-green-600">B</div>
                    <input type="text" id="teamName" value="Bursaspor" class="bg-transparent text-2xl font-black text-white outline-none border-b border-gray-800 focus:border-green-500 transition-all">
                </div>
                <div class="flex gap-2">
                    <input type="file" id="fmImport" class="hidden" onchange="importFMData(this)">
                    <button onclick="document.getElementById('fmImport').click()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-[10px] font-black tracking-tighter">ðŸ“‚ FM KADRO YÃœKLE</button>
                    <input type="color" oninput="document.documentElement.style.setProperty('--team-color', this.value)" value="#1a7a3a" class="w-10 h-10 bg-transparent cursor-pointer rounded">
                </div>
            </div>

            <div class="space-y-4">
                <h3 class="text-[10px] font-black text-gray-500 uppercase tracking-widest">Taktik Kurulumu</h3>
                <select id="formationSelect" onchange="updateFormationSelection()" class="w-full bg-black border border-gray-700 rounded-xl p-3 text-sm font-bold text-white outline-none">
                    <option value="4231_2dos">4-2-3-1 (2 DOS)</option>
                    <option value="433_heavy">4-3-3 (Ofansif)</option>
                    <option value="343_diamond">3-4-3 (Elmas)</option>
                    <option value="352_flat">3-5-2 (DÃ¼z Orta Saha)</option>
                    <option value="5212_wb">5-2-1-2 (Kanat Bekli)</option>
                    <option value="424_wide">4-2-4 (HÃ¼cumcu)</option>
                    <option value="41212_narrow">4-1-2-1-2 (Dar Elmas)</option>
                    <option value="3223_wm">3-2-2-3 (WM Taktik)</option>
                    <option value="3313_bielsa">3-3-1-3 (Bielsa)</option>
                    <option value="4222_box">4-2-2-2 (Kutu)</option>
                    <option value="532_park">5-3-2 (Savunma)</option>
                    <option value="4141_anchor">4-1-4-1 (Ã‡apa)</option>
                    <option value="0striker_460">4-6-0 (Forvetsiz)</option>
                </select>
                <div class="flex gap-2">
                    <input type="text" id="playerManual" placeholder="Yeni oyuncu adÄ±..." class="flex-grow bg-black border border-gray-700 rounded-lg p-2 text-xs text-white">
                    <button onclick="manualAdd()" class="bg-green-600 px-4 rounded-lg font-bold">+</button>
                </div>
            </div>

            <div class="flex flex-col justify-center gap-3">
                <div class="flex bg-black p-1.5 rounded-2xl border border-gray-800 shadow-inner">
                    <button id="btnAtk" onclick="switchTacticMode('attack')" class="flex-1 py-3 text-[10px] font-black rounded-xl bg-green-700 text-white shadow-lg transition-all">TOPA SAHÄ°PKEN</button>
                    <button id="btnDef" onclick="switchTacticMode('defense')" class="flex-1 py-3 text-[10px] font-black rounded-xl text-gray-500 transition-all">TOP RAKÄ°PTEYKEN</button>
                </div>
                <p class="text-[9px] text-gray-500 text-center font-bold uppercase tracking-tighter">Kadro korunur, diziliÅŸ deÄŸiÅŸir</p>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <div class="lg:col-span-2 space-y-4">
                <div class="bg-gray-900 p-5 rounded-3xl border border-gray-800 shadow-xl">
                    <h3 class="text-[11px] font-black text-red-500 mb-4 uppercase">Eksik BÃ¶lgeler</h3>
                    <div id="transferRadar" class="space-y-2"></div>
                </div>
            </div>

            <div class="lg:col-span-7">
                <div class="pitch" id="pitch">
                    <div id="pitchPlayers"></div>
                </div>
            </div>

            <div class="lg:col-span-3">
                <div class="bg-gray-900 p-6 rounded-3xl border border-gray-800 h-[750px] flex flex-col shadow-2xl">
                    <h3 class="text-xs font-black text-yellow-500 mb-6 uppercase tracking-widest flex justify-between">
                        <span>ðŸ’º OYUNCU HAVUZU</span>
                        <span id="pCount" class="text-gray-600 text-[10px]">0</span>
                    </h3>
                    <div id="bench" class="flex-grow overflow-y-auto space-y-3 pr-2 custom-scroll"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const formations = {
            "4231_2dos": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"82%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"8%"},{p:"DOS",b:"60%",l:"55%"},{p:"DOS",b:"60%",l:"35%"},{p:"SÄžK",b:"28%",l:"82%"},{p:"OOS",b:"32%",l:"45%"},{p:"SLK",b:"28%",l:"8%"},{p:"SNT",b:"10%",l:"45%"}],
            "433_heavy": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"85%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"5%"},{p:"MO",b:"50%",l:"45%"},{p:"MO",b:"50%",l:"65%"},{p:"MO",b:"50%",l:"25%"},{p:"SÄžK",b:"20%",l:"80%"},{p:"SLK",b:"20%",l:"10%"},{p:"SNT",b:"10%",l:"45%"}],
            "343_diamond": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"65%"},{p:"STP",b:"78%",l:"25%"},{p:"DOS",b:"60%",l:"45%"},{p:"MO",b:"45%",l:"70%"},{p:"MO",b:"45%",l:"20%"},{p:"OOS",b:"30%",l:"45%"},{p:"SÄžK",b:"20%",l:"85%"},{p:"SLK",b:"20%",l:"5%"},{p:"SNT",b:"10%",l:"45%"}],
            "352_flat": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"80%",l:"45%"},{p:"STP",b:"78%",l:"65%"},{p:"STP",b:"78%",l:"25%"},{p:"SÄžKB",b:"50%",l:"88%"},{p:"MO",b:"55%",l:"60%"},{p:"MO",b:"55%",l:"45%"},{p:"MO",b:"55%",l:"30%"},{p:"SLKB",b:"50%",l:"2%"},{p:"SNT",b:"15%",l:"55%"},{p:"SNT",b:"15%",l:"35%"}],
            "5212_wb": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"62%"},{p:"STP",b:"78%",l:"28%"},{p:"SÄžKB",b:"60%",l:"88%"},{p:"SLKB",b:"60%",l:"2%"},{p:"MO",b:"50%",l:"55%"},{p:"MO",b:"50%",l:"35%"},{p:"OOS",b:"30%",l:"45%"},{p:"SNT",b:"12%",l:"58%"},{p:"SNT",b:"12%",l:"32%"}],
            "3223_wm": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"65%"},{p:"STP",b:"78%",l:"25%"},{p:"DOS",b:"65%",l:"58%"},{p:"DOS",b:"65%",l:"32%"},{p:"MO",b:"45%",l:"58%"},{p:"MO",b:"45%",l:"32%"},{p:"SÄžK",b:"20%",l:"85%"},{p:"SLK",b:"20%",l:"5%"},{p:"SNT",b:"10%",l:"45%"}],
            "0striker_460": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"85%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"5%"},{p:"MO",b:"55%",l:"55%"},{p:"MO",b:"55%",l:"35%"},{p:"MO",b:"35%",l:"65%"},{p:"MO",b:"35%",l:"25%"},{p:"OOS",b:"20%",l:"55%"},{p:"OOS",b:"20%",l:"35%"}],
            "424_wide": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"85%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"5%"},{p:"MO",b:"50%",l:"55%"},{p:"MO",b:"50%",l:"35%"},{p:"SÄžK",b:"15%",l:"88%"},{p:"SLK",b:"15%",l:"2%"},{p:"SNT",b:"10%",l:"55%"},{p:"SNT",b:"10%",l:"35%"}],
            "41212_narrow": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"85%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"5%"},{p:"DOS",b:"60%",l:"45%"},{p:"MO",b:"45%",l:"65%"},{p:"MO",b:"45%",l:"25%"},{p:"OOS",b:"30%",l:"45%"},{p:"SNT",b:"12%",l:"55%"},{p:"SNT",b:"12%",l:"35%"}],
            "3313_bielsa": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"80%",l:"45%"},{p:"STP",b:"78%",l:"68%"},{p:"STP",b:"78%",l:"22%"},{p:"DOS",b:"65%",l:"45%"},{p:"MO",b:"50%",l:"75%"},{p:"MO",b:"50%",l:"15%"},{p:"OOS",b:"35%",l:"45%"},{p:"SÄžK",b:"15%",l:"88%"},{p:"SLK",b:"15%",l:"2%"},{p:"SNT",b:"8%",l:"45%"}],
            "532_park": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"62%"},{p:"STP",b:"78%",l:"28%"},{p:"STP",b:"78%",l:"78%"},{p:"STP",b:"78%",l:"12%"},{p:"MO",b:"60%",l:"58%"},{p:"MO",b:"60%",l:"32%"},{p:"MO",b:"58%",l:"45%"},{p:"SNT",b:"15%",l:"55%"},{p:"SNT",b:"15%",l:"35%"}],
            "4222_box": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"82%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"8%"},{p:"DOS",b:"60%",l:"58%"},{p:"DOS",b:"60%",l:"32%"},{p:"MO",b:"40%",l:"58%"},{p:"MO",b:"40%",l:"32%"},{p:"SNT",b:"12%",l:"55%"},{p:"SNT",b:"12%",l:"35%"}],
            "4141_anchor": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"85%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"5%"},{p:"DOS",b:"62%",l:"45%"},{p:"MO",b:"45%",l:"75%"},{p:"MO",b:"45%",l:"60%"},{p:"MO",b:"45%",l:"30%"},{p:"MO",b:"45%",l:"15%"},{p:"SNT",b:"12%",l:"45%"}]
        };

        // ANA HAFIZA (11 Oyuncu Yeri)
        let squadPlayers = Array(11).fill("---");
        let currentMode = 'attack';
        let modeFormations = { attack: '4231_2dos', defense: '4231_2dos' };
        let playerPool = ["Sedat Cengiz", "YiÄŸit Fidan", "ErtuÄŸrul Ersoy", "Furkan Emre", "MÃ¼cahit Can"];

        function switchTacticMode(mode) {
            currentMode = mode;
            document.getElementById('btnAtk').className = mode === 'attack' ? 'flex-1 py-3 text-[10px] font-black rounded-xl bg-green-700 text-white shadow-lg' : 'flex-1 py-3 text-[10px] font-black rounded-xl text-gray-500 hover:text-white';
            document.getElementById('btnDef').className = mode === 'defense' ? 'flex-1 py-3 text-[10px] font-black rounded-xl bg-red-900 text-white shadow-lg' : 'flex-1 py-3 text-[10px] font-black rounded-xl text-gray-500 hover:text-white';
            document.getElementById('pitch').className = mode === 'defense' ? 'pitch defensive' : 'pitch';
            document.getElementById('formationSelect').value = modeFormations[currentMode];
            renderPitch();
        }

        function updateFormationSelection() {
            modeFormations[currentMode] = document.getElementById('formationSelect').value;
            renderPitch();
        }

        function renderPitch() {
            const container = document.getElementById('pitchPlayers');
            container.innerHTML = '';
            const activeFormPositions = formations[modeFormations[currentMode]] || formations["4231_2dos"];

            activeFormPositions.forEach((pos, i) => {
                const div = document.createElement('div');
                div.className = 'player-slot';
                div.style.bottom = pos.b; div.style.left = pos.l;
                div.innerHTML = `
                    <div class="pos-badge">${pos.p}</div>
                    <div class="kit-icon" ondrop="handleDrop(event, ${i})" ondragover="event.preventDefault()"></div>
                    <div class="player-name-label">${squadPlayers[i]}</div>
                `;
                container.appendChild(div);
            });
            updateRadar();
        }

        function handleDrop(ev, squadIndex) {
            ev.preventDefault();
            const playerName = ev.dataTransfer.getData("name");
            
            // EÄŸer o slotta zaten biri varsa onu havuza iade et
            if(squadPlayers[squadIndex] !== "---") {
                playerPool.push(squadPlayers[squadIndex]);
            }

            squadPlayers[squadIndex] = playerName;
            playerPool = playerPool.filter(p => p !== playerName);
            
            renderBench();
            renderPitch();
        }

        function importFMData(input) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const lines = e.target.result.split('\n');
                lines.forEach(l => {
                    let n = l.split('\t')[0].trim();
                    if(n.length > 2 && !playerPool.includes(n)) playerPool.push(n);
                });
                renderBench();
            };
            reader.readAsText(input.files[0], 'ISO-8859-9');
        }

        function manualAdd() {
            const v = document.getElementById('playerManual').value.trim();
            if(v) { 
                playerPool.push(v); 
                renderBench(); 
                document.getElementById('playerManual').value = ''; 
            }
        }

        function renderBench() {
            const b = document.getElementById('bench');
            b.innerHTML = playerPool.map(n => `
                <div class="bench-item" draggable="true" ondragstart="event.dataTransfer.setData('name','${n}')">
                    ${n}
                </div>
            `).join('');
            document.getElementById('pCount').innerText = playerPool.length;
        }

        function updateRadar() {
            const activeForm = formations[modeFormations[currentMode]];
            const radar = document.getElementById('transferRadar');
            let needs = [];

            activeForm.forEach((pos, i) => {
                if(squadPlayers[i] === "---") needs.push(pos.p);
            });

            const unique = [...new Set(needs)];
            radar.innerHTML = unique.length ? unique.map(n => `
                <div class="bg-red-900/20 border border-red-900/30 p-3 rounded-2xl text-[10px] font-black text-red-400">
                    ðŸ”´ ${n} Ä°HTÄ°YACI
                </div>
            `).join('') : '<div class="text-[10px] text-green-500 font-bold text-center">TAM KADRO</div>';
        }

        // BAÅžLANGIÃ‡
        renderBench();
        renderPitch();
    </script>
</body>
</html>
