<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FM26 Strateji TahtasÄ± - Saha Ä°Ã§i SÃ¼rÃ¼kle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --team-color: #1a7a3a; }
        body { background-color: #0d1117; color: #e6edf3; font-family: 'Inter', sans-serif; overflow: hidden; }
        
        .pitch { 
            background: #1e3d24; border: 4px solid #ffffff33; position: relative; height: 720px; width: 100%; border-radius: 20px;
            background-image: repeating-linear-gradient(#244a2b 0, #244a2b 50px, #1e3d24 50px, #1e3d24 100px);
            box-shadow: inset 0 0 100px rgba(0,0,0,0.8); transition: all 0.6s ease;
        }
        .pitch.defensive { background-color: #2b1a1a; background-image: repeating-linear-gradient(#3d1e1e 0, #3d1e1e 50px, #2b1a1a 50px, #2b1a1a 100px); }

        .player-slot { position: absolute; width: 100px; text-align: center; z-index: 20; transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        
        .kit-icon { 
            width: 55px; height: 55px; margin: 0 auto; background-color: var(--team-color); 
            border: 2px solid white; border-radius: 12px; cursor: grab;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4); transition: transform 0.2s;
        }
        .kit-icon:active { cursor: grabbing; transform: scale(1.1); }
        .drag-over .kit-icon { border: 3px dashed gold; background-color: rgba(255,255,255,0.2); }

        .player-name-label { 
            font-size: 10px; font-weight: bold; background: rgba(0,0,0,0.85); padding: 3px; 
            border-radius: 5px; margin-top: 6px; border: 1px solid #444; color: white;
            min-height: 22px; pointer-events: none;
        }
        
        .bench-item { 
            cursor: grab; background: #161b22; border: 1px solid #30363d; padding: 10px; 
            border-radius: 10px; font-size: 11px; font-weight: 700; transition: 0.2s;
        }
        .bench-item:hover { border-color: var(--team-color); background: #1c2128; }
        .pos-badge { font-size: 9px; font-weight: 900; color: #ffffffaa; margin-bottom: 2px; }
    </style>
</head>
<body class="p-4 lg:p-6">
    <div class="max-w-[1600px] mx-auto">
        
        <header class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6 bg-gray-900 p-6 rounded-3xl border border-gray-800 shadow-2xl">
            <div class="flex flex-col gap-4">
                <div class="flex items-center gap-4">
                    <div id="teamLogo" class="w-12 h-12 bg-white rounded-xl flex items-center justify-center font-black text-black text-xl border-4 border-green-600">B</div>
                    <input type="text" id="teamName" value="Bursaspor" class="bg-transparent text-xl font-black text-white outline-none border-b border-gray-800">
                </div>
                <div class="flex gap-2">
                    <input type="file" id="fmImport" class="hidden" onchange="importFMData(this)">
                    <button onclick="document.getElementById('fmImport').click()" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-[10px] font-black">ðŸ“‚ KADRO YÃœKLE</button>
                    <input type="color" oninput="document.documentElement.style.setProperty('--team-color', this.value)" value="#1a7a3a" class="w-8 h-8 bg-transparent cursor-pointer">
                </div>
            </div>

            <div class="space-y-4">
                <select id="formationSelect" onchange="updateFormationSelection()" class="w-full bg-black border border-gray-700 rounded-xl p-2.5 text-sm font-bold text-white outline-none">
                    <option value="4231_2dos">4-2-3-1 (2 DOS)</option>
                    <option value="433_heavy">4-3-3 (Ofansif)</option>
                    <option value="343_diamond">3-4-3 (Elmas)</option>
                    <option value="352_flat">3-5-2 (DÃ¼z Orta Saha)</option>
                    <option value="5212_wb">5-2-1-2 (Kanat Bekli)</option>
                    <option value="424_wide">4-2-4 (HÃ¼cumcu)</option>
                    <option value="3223_wm">3-2-2-3 (WM Taktik)</option>
                    <option value="532_park">5-3-2 (Savunma)</option>
                </select>
                <div class="flex gap-2">
                    <input type="text" id="playerManual" placeholder="Yeni oyuncu..." class="flex-grow bg-black border border-gray-700 rounded-lg p-2 text-xs text-white">
                    <button onclick="manualAdd()" class="bg-green-600 px-4 rounded-lg font-bold">+</button>
                </div>
            </div>

            <div class="flex flex-col justify-center gap-2">
                <div class="flex bg-black p-1 rounded-2xl border border-gray-800">
                    <button id="btnAtk" onclick="switchTacticMode('attack')" class="flex-1 py-3 text-[10px] font-black rounded-xl bg-green-700 text-white shadow-lg transition-all">TOPA SAHÄ°PKEN</button>
                    <button id="btnDef" onclick="switchTacticMode('defense')" class="flex-1 py-3 text-[10px] font-black rounded-xl text-gray-500 transition-all">TOP RAKÄ°PTEYKEN</button>
                </div>
                <p class="text-[9px] text-gray-500 text-center font-bold">SAHA Ä°Ã‡Ä°NDE DE SÃœRÃœKLE-BIRAK YAPABÄ°LÄ°RSÄ°NÄ°Z</p>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <div class="lg:col-span-2">
                <div class="bg-gray-900 p-4 rounded-2xl border border-gray-800 h-full"><h3 class="text-[10px] font-black text-red-500 mb-4 uppercase">EKSÄ°KLER</h3><div id="transferRadar" class="space-y-2"></div></div>
            </div>

            <div class="lg:col-span-7">
                <div class="pitch" id="pitch"><div id="pitchPlayers"></div></div>
            </div>

            <div class="lg:col-span-3">
                <div class="bg-gray-900 p-5 rounded-2xl border border-gray-800 h-[720px] flex flex-col shadow-2xl">
                    <h3 class="text-xs font-black text-yellow-500 mb-4 uppercase tracking-widest">ðŸ’º OYUNCU HAVUZU</h3>
                    <div id="bench" class="flex-grow overflow-y-auto space-y-2 pr-2"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const formations = {
            "4231_2dos": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"82%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"8%"},{p:"DOS",b:"60%",l:"55%"},{p:"DOS",b:"60%",l:"35%"},{p:"SÄžK",b:"28%",l:"82%"},{p:"OOS",b:"32%",l:"45%"},{p:"SLK",b:"28%",l:"8%"},{p:"SNT",b:"10%",l:"45%"}],
            "433_heavy": [{p:"KL",b:"90%",l:"45%"},{p:"SÄžB",b:"70%",l:"85%"},{p:"STP",b:"78%",l:"58%"},{p:"STP",b:"78%",l:"32%"},{p:"SLB",b:"70%",l:"5%"},{p:"MO",b:"50%",l:"45%"},{p:"MO",b:"50%",l:"65%"},{p:"MO",b:"50%",l:"25%"},{p:"SÄžK",b:"20%",l:"80%"},{p:"SLK",b:"20%",l:"10%"},{p:"SNT",b:"10%",l:"45%"}],
            "343_diamond": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"65%"},{p:"STP",b:"78%",l:"25%"},{p:"DOS",b:"60%",l:"45%"},{p:"MO",b:"45%",l:"70%"},{p:"MO",b:"45%",l:"20%"},{p:"OOS",b:"30%",l:"45%"},{p:"SÄžK",b:"20%",l:"85%"},{p:"SLK",b:"20%",l:"5%"},{p:"SNT",b:"10%",l:"45%"}],
            "352_flat": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"80%",l:"45%"},{p:"STP",b:"78%",l:"65%"},{p:"STP",b:"78%",l:"25%"},{p:"SÄžKB",b:"50%",l:"88%"},{p:"MO",b:"55%",l:"60%"},{p:"MO",b:"55%",l:"45%"},{p:"MO",b:"55%",l:"30%"},{p:"SLKB",b:"50%",l:"2%"},{p:"SNT",b:"15%",l:"55%"},{p:"SNT",b:"15%",l:"35%"}],
            "5212_wb": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"62%"},{p:"STP",b:"78%",l:"28%"},{p:"SÄžKB",b:"60%",l:"88%"},{p:"SLKB",b:"60%",l:"2%"},{p:"MO",b:"50%",l:"55%"},{p:"MO",b:"50%",l:"35%"},{p:"OOS",b:"30%",l:"45%"},{p:"SNT",b:"12%",l:"58%"},{p:"SNT",b:"12%",l:"32%"}],
            "3223_wm": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"65%"},{p:"STP",b:"78%",l:"25%"},{p:"DOS",b:"65%",l:"58%"},{p:"DOS",b:"65%",l:"32%"},{p:"MO",b:"45%",l:"58%"},{p:"MO",b:"45%",l:"32%"},{p:"SÄžK",b:"20%",l:"85%"},{p:"SLK",b:"20%",l:"5%"},{p:"SNT",b:"10%",l:"45%"}],
            "532_park": [{p:"KL",b:"90%",l:"45%"},{p:"STP",b:"82%",l:"45%"},{p:"STP",b:"78%",l:"62%"},{p:"STP",b:"78%",l:"28%"},{p:"STP",b:"78%",l:"78%"},{p:"STP",b:"78%",l:"12%"},{p:"MO",b:"60%",l:"58%"},{p:"MO",b:"60%",l:"32%"},{p:"MO",b:"58%",l:"45%"},{p:"SNT",b:"15%",l:"55%"},{p:"SNT",b:"15%",l:"35%"}]
        };

        let squad = Array(11).fill("---");
        let currentMode = 'attack';
        let modeForms = { attack: '4231_2dos', defense: '4231_2dos' };
        let pool = ["Kerem MatÄ±ÅŸlÄ±", "YiÄŸit Fidan", "ErtuÄŸrul Ersoy", "Sedat Cengiz"];

        function renderPitch() {
            const container = document.getElementById('pitchPlayers');
            container.innerHTML = '';
            const form = formations[modeForms[currentMode]];

            form.forEach((pos, i) => {
                const div = document.createElement('div');
                div.className = 'player-slot';
                div.style.bottom = pos.b; div.style.left = pos.l;
                div.dataset.index = i;
                
                div.innerHTML = `
                    <div class="pos-badge">${pos.p}</div>
                    <div class="kit-icon" draggable="true" 
                         ondragstart="handleDragStart(event, ${i})" 
                         ondrop="handleDrop(event, ${i})" 
                         ondragover="handleDragOver(event)" 
                         ondragleave="handleDragLeave(event)">
                        <span class="text-white text-[10px] opacity-20">FM</span>
                    </div>
                    <div class="player-name-label">${squad[i]}</div>
                `;
                container.appendChild(div);
            });
            updateRadar();
        }

        function handleDragStart(ev, index) {
            ev.dataTransfer.setData("sourceIndex", index);
            ev.dataTransfer.setData("playerName", squad[index]);
            ev.dataTransfer.setData("type", index === -1 ? "pool" : "pitch");
        }

        function handleDragOver(ev) {
            ev.preventDefault();
            ev.currentTarget.closest('.player-slot').classList.add('drag-over');
        }

        function handleDragLeave(ev) {
            ev.currentTarget.closest('.player-slot').classList.remove('drag-over');
        }

        function handleDrop(ev, targetIndex) {
            ev.preventDefault();
            ev.currentTarget.closest('.player-slot').classList.remove('drag-over');
            
            const sourceIndex = ev.dataTransfer.getData("sourceIndex");
            const playerName = ev.dataTransfer.getData("playerName");
            const type = ev.dataTransfer.getData("type");

            if (playerName === "---") return;

            if (type === "pitch" && sourceIndex != targetIndex) {
                // Saha iÃ§i yer deÄŸiÅŸtirme (Swap)
                const temp = squad[targetIndex];
                squad[targetIndex] = squad[sourceIndex];
                squad[sourceIndex] = temp;
            } else if (type === "pool") {
                // Havuzdan sahaya
                if (squad[targetIndex] !== "---") pool.push(squad[targetIndex]);
                squad[targetIndex] = playerName;
                pool = pool.filter(p => p !== playerName);
            }
            
            renderBench();
            renderPitch();
        }

        function switchTacticMode(mode) {
            currentMode = mode;
            document.getElementById('btnAtk').className = mode === 'attack' ? 'flex-1 py-3 text-[10px] font-black rounded-xl bg-green-700 text-white shadow-lg' : 'flex-1 py-3 text-[10px] font-black rounded-xl text-gray-500';
            document.getElementById('btnDef').className = mode === 'defense' ? 'flex-1 py-3 text-[10px] font-black rounded-xl bg-red-900 text-white shadow-lg' : 'flex-1 py-3 text-[10px] font-black rounded-xl text-gray-500';
            document.getElementById('pitch').className = mode === 'defense' ? 'pitch defensive' : 'pitch';
            document.getElementById('formationSelect').value = modeForms[currentMode];
            renderPitch();
        }

        function updateFormationSelection() {
            modeForms[currentMode] = document.getElementById('formationSelect').value;
            renderPitch();
        }

        function renderBench() {
            const b = document.getElementById('bench');
            b.innerHTML = pool.map(n => `
                <div class="bench-item" draggable="true" ondragstart="handleDragStart(event, -1); event.dataTransfer.setData('playerName', '${n}'); event.dataTransfer.setData('type', 'pool')">
                    ${n}
                </div>
            `).join('');
        }

        function importFMData(input) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const lines = e.target.result.split('\n');
                lines.forEach(l => {
                    let n = l.split('\t')[0].trim();
                    if(n.length > 2 && !pool.includes(n)) pool.push(n);
                });
                renderBench();
            };
            reader.readAsText(input.files[0], 'ISO-8859-9');
        }

        function manualAdd() {
            const v = document.getElementById('playerManual').value.trim();
            if(v) { pool.push(v); renderBench(); document.getElementById('playerManual').value = ''; }
        }

        function updateRadar() {
            const needs = formations[modeForms[currentMode]].filter((_,i) => squad[i] === "---").map(p => p.p);
            document.getElementById('transferRadar').innerHTML = [...new Set(needs)].map(n => `<div class="bg-red-900/20 p-2 rounded text-[9px] font-bold">ðŸ”´ ${n}</div>`).join('');
        }

        renderBench();
        renderPitch();
    </script>
</body>
</html>
